{% extends "layout.html" %}

{% block main %}
<div class="flex" id="screen-panel">
    <div class="w-1/8 h-screen items-center justify-center text-center" id="left-panel">
        <div class="h-1/2 text-wrap justify-center flex" id="volume-panel">
            <table class="text-center table-fixed w-full">
                <thead>
                    <tr class="h-12">
                        <th class="w-4/9">Ticker</th>
                        <th class="w-4/9">Volume</th>
                        <th class="w-1/9"></th>
                    </tr>
                </thead>
                <tbody>

                    {% for item in volumeData %}
                        <tr class="border-y border-solid border-collapse border-slate-400 bg-slate-600 hover:bg-slate-700 stock-item">
                            <td class="ticker-code cursor-pointer">
                                {{ item.ticker }}
                            </td>
                            <td>
                                {{ item.volume }}
                            </td>
                            <td>
                                <input type="hidden" name="q" value="{{ item.ticker }}">
                                <form class="fav-form" action="/favourite" method="get">
                                    
                                            
                                    <svg class="hover:fill-slate-200 cursor-pointer add_favourite stock-list-item" fill="#475569" height="20px" width="20px" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 455 455" xml:space="preserve"><g stroke-width="0"></g><g stroke-linecap="round" stroke-linejoin="round"></g><g> <polygon points="455,212.5 242.5,212.5 242.5,0 212.5,0 212.5,212.5 0,212.5 0,242.5 212.5,242.5 212.5,455 242.5,455 242.5,242.5 455,242.5 "></polygon> </g></svg> 
                              
                                </form>
                            </td>
                        </tr>
                        
                    {% endfor %}
                </tbody>
            </table>
        </div>
    
        <div class="h-1/2" id="favourites">
            <table class="text-center table-fixed w-full">
                <thead>
                    <tr class="h-12">
                        <th class="w-4/9">Ticker</th>
                        <th class="w-4/9">7 Day</th>
                        <th class="w-1/9"></th>
                    </tr>
                </thead>

                <tbody id="favourite-list">
                    {% for item in favouritesList %}
                    <tr class="border-y h-10 border-solid border-collapse border-slate-400 bg-slate-600 hover:bg-slate-700 stock-item">
                        <td class="ticker-code cursor-pointer">
                            {{ item.ticker }}
                        </td>
                        <td class="flex align-middle justify-evenly">
                            {% if item.change > 0 %}
                                <svg class="block" width="20px" height="20px" viewBox="0 0 16.00 16.00" fill="none" xmlns="http://www.w3.org/2000/svg" transform="rotate(0)matrix(1, 0, 0, 1, 0, 0)" stroke="#0ea5e9"><g stroke-width="0"></g><g stroke-linecap="round" stroke-linejoin="round" stroke="#0ea5e9" stroke-width="0.032"></g><g> <path d="M6 8L2 8L2 6L8 5.24536e-07L14 6L14 8L10 8L10 16L6 16L6 8Z" fill="#0ea5e9"></path> </g></svg>
                            {% else %}
                                <svg class="block" width="20px" height="20px" viewBox="0 0 16.00 16.00" fill="none" xmlns="http://www.w3.org/2000/svg" transform="rotate(0)matrix(1, 0, 0, -1, 0, 0)" stroke="#ec4899"><g stroke-width="0"></g><g stroke-linecap="round" stroke-linejoin="round" stroke="#ec4899" stroke-width="0.032"></g><g> <path d="M6 8L2 8L2 6L8 5.24536e-07L14 6L14 8L10 8L10 16L6 16L6 8Z" fill="#ec4899"></path> </g></svg>
                            {% endif %}

                           <p class="block h-full">{{item.change}} %</p> 
                        </td>
                        <td>
                            <input type="hidden" name="q" value="{{ item.ticker }}">
                            <form class="fav-form" action="/favourite" method="get">
                                
                                <svg class="cursor-pointer remove_favourite" width="20px" height="20px" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg"><g> <path class="hover:stroke-slate-200" d="M6 12L18 12" stroke="#475569" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>
                            </form>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>

        </div>
    </div>
    
    <div class="w-5/8 h-screen  text-center" id="main-panel">
            <div class="" id="main-panel-top">
                <div class="flex h-12 w-full">
                    <div class="w-1/2"> </div>
                    <div class="w-1/2 bg-slate-700 flex">
                        <div class="flex w-full justify-end items-center">
                            <a href="/portfolio" class="rounded-lg border w-28 text-center py-1 mx-4 hover:from-cyan-500 hover:bg-linear-to-r to-blue-500 hover:border-0">Portfolio</a>
                            <a href="/account" class="rounded-lg border w-28 text-center py-1 mx-4 hover:from-cyan-500 hover:bg-linear-to-r to-blue-500 hover:border-0">Account</a>
                            <a href="/logout" class="rounded-lg border w-28 text-center py-1 mx-4 hover:from-cyan-500 hover:bg-linear-to-r to-blue-500 hover:border-0">Logout</a>    
                        </div>
                    </div>
                </div>
            </div>
        <div class="size-full" id="main-panel-center">
            <div class="w-full h-12 bg-slate-500 flex justify-evenly relative" id="chart-search-panel">
                <input type="search" class="border-slate-950 border-solid rounded-md border my-1 text-center" autofocus id="search" placeholder="Search code">
                <div class="bg-slate-300 w-2/8 h-auto absolute z-10 top-full" id="search-container">
                    
                    <ul id="search-results">
                        <!-- search results go here -->
                    </ul>
                </div>
            </div>

            <div class="h-5/8 w-full bg-slate-700 flex-col place-items-center" id="main-panel-chart">
                
                <div id="centre-fav-container" class="flex justify-end w-full">
                    <input type="hidden" id="current-ticker">
                    <svg id="centre-fav-add" class="hover:fill-slate-200 cursor-pointer m-4" fill="#475569" height="30px" width="30px" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 455 455" xml:space="preserve"><g stroke-width="0"></g><g stroke-linecap="round" stroke-linejoin="round"></g><g> <polygon points="455,212.5 242.5,212.5 242.5,0 212.5,0 212.5,212.5 0,212.5 0,242.5 212.5,242.5 212.5,455 242.5,455 242.5,242.5 455,242.5 "></polygon> </g></svg> 
                </div>

                    
                <div id="main-chart" class="w-4/5 h-4/5">
                    <!-- This is where the graph goes -->
                </div>
                <input type="date" class="chartDates border-slate-950 border-solid rounded-md border my-1" placeholder="Date from" id="dateFrom">
                <input type="date" class="chartDates border-slate-950 border-solid rounded-md border my-1" placeholder="Date to" id="dateTo">

            </div>
            <div class="w-full justify-center flex" id="data-container">
                <div class="w-1/2 bg-slate-400 flex justify-center" id="data-left">
                    <table class="table-fixed">
                        <tr>
                            <td>Ticker:</td>
                            <td class="table_field" id="ticker"></td>
                        </tr>
                        <tr>
                            <td>Data Timestamp:</td>
                            <td class="table_field" id="timestamp"></td>
                        </tr>
                        <tr>
                            <td>Last Price:</td>
                            <td class="table_field" id="last"></td>
                        </tr>
                        <tr>
                            <td>Previous Close:</td>
                            <td class="table_field" id="prevClose"></td>
                        </tr>
                        <tr>
                            <td>Open Price:</td>
                            <td class="table_field" id="open"></td>
                        </tr>
                        <tr>
                            <td>High:</td>
                            <td class="table_field" id="high"></td>
                        </tr>
                        <tr>
                            <td>Low:</td>
                            <td class="table_field" id="low"></td>
                        </tr>
                        <tr>
                            <td>Mid:</td>
                            <td class="table_field" id="mid"></td>
                        </tr>
                        <tr>
                            <td>Volume</td>
                            <td class="table_field" id="volume"></td>
                        </tr>
                    </table>
                </div>
                <div class="w-1/2 bg-slate-300" id="data-right">
                    <!-- STOCK INFO META DATA HERE -->
                     <p class="table_field" id="info">Stock meta data</p>
                </div>
            </div>
        </div>

    </div>
    
    <div class=" w-2/8 h-screen text-center flex justify-between" id="right-panel">
        <table class="table-fixed w-1/2">
            <thead>
                <tr class="h-12">
                    <th class="w-4/9">Ticker</th>
                    <th class="w-4/9">Biggest Gain</th>
                    <th class="w-1/9"></th>
                </tr>
            </thead>
            <tbody>

                {% for item in differenceData %}
                    <tr class="border-y border-solid border-collapse border-slate-400 bg-slate-600 hover:bg-slate-700 stock-item">
                        <td class="ticker-code cursor-pointer">
                            {{ item.ticker }}
                        </td>
                        <td>
                            {{ item.difference }}
                        </td>
                        <td>
                            <input type="hidden" name="q" value="{{ item.ticker }}">
                            <form class="fav-form" action="/favourite" method="get">
                                
                                <svg class="hover:fill-slate-200 cursor-pointer add_favourite stock-list-item" fill="#475569" height="20px" width="20px" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 455 455" xml:space="preserve"><g stroke-width="0"></g><g stroke-linecap="round" stroke-linejoin="round"></g><g> <polygon points="455,212.5 242.5,212.5 242.5,0 212.5,0 212.5,212.5 0,212.5 0,242.5 212.5,242.5 212.5,455 242.5,455 242.5,242.5 455,242.5 "></polygon> </g></svg> 
                            </form>
                        </td>
                    </tr>
                    
                {% endfor %}
            </tbody>
        </table>
        <table class="table-fixed w-1/2">
            <thead>
                <tr class="h-12">
                    <th class="w-4/9">Ticker</th>
                    <th class="w-4/9">Biggest Loss</th>
                    <th class="w-1/9"></th>
                </tr>
            </thead>
            <tbody>

                {% for item in differenceDataReverse %}
                    <tr class="border-y border-solid border-collapse border-slate-400 bg-slate-600 hover:bg-slate-700 stock-item">
                        <td class="ticker-code cursor-pointer">
                            {{ item.ticker }}
                        </td>
                        <td>
                            {{ item.difference }}
                        </td>
                        <td>
                            <input type="hidden" name="q" value="{{ item.ticker }}">
                            <form class="fav-form" action="/favourite" method="get">
                                
                                <svg class="hover:fill-slate-200 cursor-pointer add_favourite stock-list-item" fill="#475569" height="20px" width="20px" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 455 455" xml:space="preserve"><g stroke-width="0"></g><g stroke-linecap="round" stroke-linejoin="round"></g><g> <polygon points="455,212.5 242.5,212.5 242.5,0 212.5,0 212.5,212.5 0,212.5 0,242.5 212.5,242.5 212.5,455 242.5,455 242.5,242.5 455,242.5 "></polygon> </g></svg> 
                            </form>
                        </td>
                    </tr>
                    
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<script>

    window.onload = (event) => {
        update_page();
        update_favourites();
    };
</script>


{% endblock %}